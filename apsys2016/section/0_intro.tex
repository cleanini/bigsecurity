\section{Introduction}

As a free online service, VirusTotal~\cite{virustotal} analyzes files submitted by real-world users to identify many different kinds of malwares, 
like viruses, worms, trojans, and so on. 
VirusTotal applies different antivirus engines to each submitted file and generate an aggregated reports. 
All submitted files and generated reports are saved and can be accessed through VirusTotalâ€™s API. 
Inspired by previous mining software repositories~\cite{GuoICSE2010,bigcode, big-lessons,big-translation,code-completion,big-predicting} 
work in software engineer and programming languages community, 
we believe leveraging data on VirusTotal could enable many ``big security'' applications.  

The repository on VirusTotal provides a valuable source to conduct data mining. 
Firstly, there are huge amount of data on VirusTotal.
Figure~\ref{fig:subnum} shows that there were more than 40 million suspicious files 
submitted in November of 2015. 
This amount of data makes VirusTotal a rough estimation of malwares in the real world. 
Secondly, all data on VirusTotal are labeled by state-of-the-art antivirus techniques. 
VirusTotal updates each antivirus engine every 5 minutes. 
Besides whether a given a submitted file is detected by an antivirus engine, VirusTotal also keeps exact detection tag returned by each engine. 
There are also online active malware researchers, 
who can comment and vote each submitted file 
and serve as an important supplement of antivirus engines. 

In industry, antivirus vendors widely use VirusTotal to identify false negatives 
and false positives in their products. 
They only utilize VirusTotal reports separately for each single suspicious file, 
but fail to consider correlations among different suspicious files. 
In academia, researchers began to pay attention to mining VirusTotal repository. 
For example, ~\citet{neeles} leverage submission\_id information to identify malware writers, 
who use VirusTotal as a test platform. 
We believe there are much more research opportunities through mining VirusTotal. 

In this paper, we conduct an empirical study on malware dataset on VirusTotal. 
An empirical study is the prerequisite to conduct data mining on VirusTotal. 
We first collect more than 40 million suspicious file submissions on VirusTotal, and then 
we focus our analysis on Windows executable and binary malwares detected Microsoft
antivirus engine to guarantee accuracy. 
Our analysis begins from general characteristics, such as submission frequency and the generation rate of malware families. 
We then specifically look into the temporal characteristic and family distribution characteristic. 
We observe that malwares do not appear uniformly across time and malware family, and they observe in bursts, 
and the family distributions of malwares are highly skewed. 
To validate our observation, we build two stream mining applications: cache-based malware prediction and hot mining family mining. 
Our malware prediction solution can achieve more than 90\% 
precision by using only 100 cache entries. 
Our hot malware family mining solution can identify hot malware families by using a constant number of counters. 


\begin{figure}[t!]
\begin{center}
\includegraphics[width=3.3in]{figure/nov}
\caption{The number of suspicious files and the number of malwares submitted to VirusTotal in November of 2015. }
\label{fig:subnum}
\end{center}
\end{figure}

To sum up, we made the following contributions in this paper:

\begin{itemize}

\item We collect data submitted to VirusTotal last November, 
and briefly analyze these data to understand the characteristics of VirusTotal repository (Section~\ref{sec:meth}). 
\item We build two stream mining applications, one could identify hot malware family in a constant number of counters (Section~\ref{sec:hot}), 
and the other could predict malwares in the near future (Section~\ref{sec:predict}). 
Experimental results show that we can cover all hot malware family with a very few false positives, and we can predict future malwares with a high precision.
\item We discuss the future research opportunities through mining data on VirusTotal (Section~\ref{sec:oppo}), 
and demonstrate the feasibility by using our experience of building stream mining applications. 

\end{itemize}



